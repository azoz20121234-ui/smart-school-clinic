<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ุงูุนูุงุฏุฉ ุงููุฏุฑุณูุฉ ุงูุฐููุฉ</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="container">
    <div class="topbar">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <div class="title">ุงูุนูุงุฏุฉ ุงููุฏุฑุณูุฉ ุงูุฐููุฉ</div>
          <div class="muted" style="font-size:12px">ููุตุฉ MVP ุชุดุบูููุฉ + ููููุฏ ุญุงูุงุช + ูุฑุงุฑ ูุฑุฒ (AI-assisted)</div>
        </div>
      </div>
      <div class="badge">GitHub Pages Ready</div>
    </div>

    <div class="grid cols-2" style="margin-top:14px">
      <div class="card">
        <h3>ุชุณุฌูู ุงูุฏุฎูู</h3>
        <p class="muted">ุญุณุงุจุงุช ุชุฌุฑูุจูุฉ: student/doctor/parent/admin โ ูููุฉ ุงููุฑูุฑ: 1234</p>
        <div class="grid" style="gap:10px">
          <input id="u" placeholder="ุงุณู ุงููุณุชุฎุฏู" value="student" />
          <input id="p" placeholder="ูููุฉ ุงููุฑูุฑ" type="password" value="1234" />
          <div class="btns">
            <button class="primary" id="loginBtn">ุฏุฎูู</button>
            <button id="resetBtn">ุฅุนุงุฏุฉ ุถุจุท ุงูุจูุงูุงุช</button>
          </div>
          <div id="loginMsg" class="muted"></div>
        </div>
        <hr class="sep"/>
        <div class="btns">
          <a class="pill green" href="student.html">ูุงุฌูุฉ ุงูุทุงูุจ</a>
          <a class="pill orange" href="doctor.html">ูุงุฌูุฉ ุงูุทุจูุจ</a>
          <a class="pill yellow" href="parent.html">ูุงุฌูุฉ ููู ุงูุฃูุฑ</a>
          <a class="pill red" href="admin.html">ุงูุฅุฏุงุฑุฉ</a>
        </div>
      </div>

      <div class="card">
        <h3>Demo Mode + ููููุฏ ุงูุญุงูุงุช</h3>
        <p class="muted">ูุถุฎ ุญุงูุงุช ุงูุชุฑุงุถูุฉ ุชููุงุฆูุงู ูุชุฌุฑุจุฉ ูุฑุงุฑ ุงููุฑุฒ ูุงููุงุฌูุงุช.</p>
        <div class="btns">
          <button class="info" id="demoStart">ุชุดุบูู Demo</button>
          <button id="demoStop">ุฅููุงู Demo</button>
          <button id="demoOnce">ุญุงูุฉ ูุงุญุฏุฉ ุงูุขู</button>
        </div>
        <hr class="sep"/>
        <div class="grid cols-3">
          <div class="kpi"><div><div class="lbl">ุฅุฌูุงูู ุงูุญุงูุงุช</div><div class="num" id="kCases">0</div></div><div>๐</div></div>
          <div class="kpi"><div><div class="lbl">ุขุฎุฑ ูุณุชูู</div><div class="num" id="kLevel">โ</div></div><div>๐ง</div></div>
          <div class="kpi"><div><div class="lbl">ุขุฎุฑ ุชุญุฏูุซ</div><div class="num" id="kTime">โ</div></div><div>โฑ</div></div>
        </div>
        <p class="muted" style="margin-top:10px">ุฅุฐุง ุงูููุตุฉ โุชุชููู ูุญุงููุงโโฆ ูุฐุง ูู ุฎููโูุฐุง Demo ๐</p>
      </div>
    </div>
  </div>

  <script type="module">
    import { login } from "./js/auth.js";
    import { loadDB, resetDB } from "./js/storage.js";
    import { toast } from "./js/ui.js";
    import { startDemo, stopDemo, runOnce } from "./js/demo.js";

    const $ = (id)=>document.getElementById(id);

    function refreshKPIs(){
      const db = loadDB();
      $("kCases").textContent = db.cases.length;
      const latest = db.cases[0];
      $("kLevel").textContent = latest?.triage?.level || "โ";
      $("kTime").textContent = latest?.updatedAt ? new Date(latest.updatedAt).toLocaleTimeString("ar-SA") : "โ";
    }

    $("loginBtn").onclick = ()=>{
      const r = login($("u").value.trim(), $("p").value);
      $("loginMsg").textContent = r.ok ? "ุชู ุชุณุฌูู ุงูุฏุฎูู โ" : r.msg;
      toast(r.ok ? "ุฃููุงู ุจู ๐" : "ุฌุฑูุจ user ุตุญูุญ + 1234");
    };

    $("resetBtn").onclick = ()=>{
      resetDB();
      toast("ุชูุช ุฅุนุงุฏุฉ ุถุจุท ุงูุจูุงูุงุช");
      refreshKPIs();
    };

    $("demoStart").onclick = ()=>{
      startDemo(7000);
      toast("Demo ุดุบูุงู โ");
      refreshKPIs();
    };
    $("demoStop").onclick = ()=>{
      stopDemo();
      toast("ุชู ุฅููุงู Demo");
    };
    $("demoOnce").onclick = ()=>{
      runOnce();
      toast("ุชู ุชูููุฏ ุญุงูุฉ ุงูุขู");
      refreshKPIs();
    };

    refreshKPIs();
    setInterval(refreshKPIs, 1500);
  </script>
</body>
</html>
