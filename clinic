
<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุงูุนูุงุฏุฉ โ ุงูุนูุงุฏุฉ ุงููุฏุฑุณูุฉ ุงูุฐููุฉ</title>
  <link rel="stylesheet" href="../styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="logo">๐ฅ</span>
      <div>
        <div class="title">ุงูุนูุงุฏุฉ ุงููุฏุฑุณูุฉ ุงูุฐููุฉ</div>
        <div class="subtitle">ุฅูุดุงุก ุชุฐูุฑุฉ + ุชุญููู ููุทุจูุจ + ููุงููุฉ ููู ุงูุฃูุฑ</div>
      </div>
    </div>

    <nav class="nav">
      <a class="navlink" href="../index.html">ุงูุฑุฆูุณูุฉ</a>
      <a class="navlink" href="./index.html">ุงูุนูุงุฏุฉ</a>
      <a class="navlink" href="../dashboards/school.html">ููุญุฉ ุงููุฏุฑุณุฉ</a>
      <a class="navlink" href="../dashboards/doctor.html">ููุญุฉ ุงูุทุจูุจ</a>
      <a class="navlink" href="../dashboards/parent.html">ููุญุฉ ููู ุงูุฃูุฑ</a>
    </nav>

    <div class="actions">
      <button class="btn ghost" id="btnLogout">ุฎุฑูุฌ</button>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h1>ุฅูุดุงุก ุทูุจ (Triage)</h1>
      <p class="muted">ูุฐุง ุงููุณู ููุซู ุงูููุฑุถุฉ/ุงูุนูุงุฏุฉ ุฏุงุฎู ุงููุฏุฑุณุฉ: ุฅุฏุฎุงู ุงูุญุงูุฉ ุซู ุชููุฒูุน ุชููุงุฆููุง ุนูู ุงูุฃุทุฑุงู.</p>

      <div class="formRow">
        <div>
          <label class="muted small">ุงุณู ุงูุทุงูุจ</label>
          <input id="student" placeholder="ูุซุงู: ูุญูุฏ" />
        </div>
        <div>
          <label class="muted small">ุฏุฑุฌุฉ ุงูุฎุทูุฑุฉ</label>
          <select id="severity">
            <option>ููุฎูุถ</option>
            <option selected>ูุชูุณุท</option>
            <option>ุญุฑุฌ</option>
          </select>
        </div>
      </div>

      <div style="margin-top:10px">
        <label class="muted small">ูุตู ุงูุญุงูุฉ</label>
        <input id="issue" placeholder="ูุซุงู: ุญุฑุงุฑุฉ + ุตุฏุงุน" />
      </div>

      <div style="margin-top:10px">
        <label class="muted small">ููุงุญุธุงุช</label>
        <textarea id="note" placeholder="ุฃู ุชูุงุตูู ุฅุถุงููุฉ..."></textarea>
      </div>

      <div style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
        <button class="btn primary" id="btnCreate">ุฅูุดุงุก ุงูุชุฐูุฑุฉ</button>
        <a class="btn" href="../dashboards/doctor.html">ุงุฐูุจ ููุทุจูุจ</a>
        <a class="btn" href="../dashboards/parent.html">ุงุฐูุจ ูููู ุงูุฃูุฑ</a>
        <a class="btn" href="../dashboards/school.html">ุงุฐูุจ ูููุฏุฑุณุฉ</a>
      </div>

      <div class="hr"></div>
      <div id="result" class="muted"></div>
    </section>

    <section class="card">
      <h2>ุขุฎุฑ ุงูุชุฐุงูุฑ</h2>
      <table class="table">
        <thead>
          <tr>
            <th>ุฑูู</th><th>ุงูุทุงูุจ</th><th>ุงูุญุงูุฉ</th><th>ุงูุฎุทูุฑุฉ</th><th>ููู ุงูุฃูุฑ</th><th>ุงูุทุจูุจ</th>
          </tr>
        </thead>
        <tbody id="tickets"></tbody>
      </table>
    </section>
  </main>

  <script src="../app.js"></script>
  <script>
    document.getElementById('btnLogout').onclick = ()=> SSC.logout();

    const render = ()=>{
      const s = SSC.getState();
      const rows = s.tickets.slice(0,8).map(t=>`
        <tr>
          <td>${t.id}</td>
          <td>${t.student}</td>
          <td>${t.issue}</td>
          <td><span class="pill ${t.severity==='ุญุฑุฌ'?'bad':(t.severity==='ูุชูุณุท'?'warn':'info')}">${t.severity}</span></td>
          <td>${t.parentStatus}</td>
          <td>${t.doctorStatus}</td>
        </tr>
      `).join("");
      document.getElementById('tickets').innerHTML = rows || `<tr><td colspan="6" class="muted">ูุง ุชูุฌุฏ ุจูุงูุงุช</td></tr>`;
    };

    document.getElementById('btnCreate').onclick = ()=>{
      const student = document.getElementById('student').value.trim() || "ุทุงูุจ";
      const issue = document.getElementById('issue').value.trim() || "ุบูุฑ ูุญุฏุฏ";
      const severity = document.getElementById('severity').value;
      const note = document.getElementById('note').value.trim();
      const id = SSC.addTicket({student, issue, severity, note});
      document.getElementById('result').innerHTML = `โ ุชู ุฅูุดุงุก ุงูุชุฐูุฑุฉ <b>${id}</b> โ ุงูุขู ุณุชุธูุฑ ูู ููุญุงุช ุงูุทุจูุจ/ุงููุฏุฑุณุฉ/ููู ุงูุฃูุฑ.`;
      render();
    };

    render();
  </script>
</body>
</html>
